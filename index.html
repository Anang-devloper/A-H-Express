<!doctype html>
<html lang="id">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>A & H Express â€” Ekspedisi Nasional</title>

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:'Poppins',sans-serif}
body{background:#f4f6f9;color:#222}
header{background:linear-gradient(135deg,#0f172a,#1e293b);color:white;padding:20px;text-align:center}
.container{max-width:850px;margin:40px auto;background:white;padding:30px;border-radius:12px;box-shadow:0 10px 30px rgba(0,0,0,.08)}
h2{text-align:center;margin-bottom:20px}
.form-group{margin-bottom:15px}
label{font-weight:600;font-size:14px}
input,select,textarea{width:100%;padding:10px;border:1px solid #ddd;border-radius:8px;margin-top:5px}
button{width:100%;padding:12px;border:none;border-radius:8px;background:#16a34a;color:white;font-weight:600;cursor:pointer}
button:hover{background:#15803d}
.result{margin-top:20px;background:#f1f5f9;padding:15px;border-radius:8px;font-size:14px}
.loading{color:#f59e0b;font-weight:600}
.error{color:red;font-weight:600}
.success{color:green;font-weight:600}
footer{text-align:center;margin-top:40px;padding:20px;color:#777}
</style>
</head>

<body>

<header>
<h1>A & H Express</h1>
<p>Semua Ekspedisi Indonesia â€¢ Tracking Real-Time</p>
</header>

<div class="container">

<h2>Form Pengiriman Paket</h2>

<form id="orderForm">

<div class="form-group">
<label>Pilih Ekspedisi</label>
<select id="courier" required>
<option value="jne">JNE</option>
<option value="jnt">J&T Express</option>
<option value="sicepat">SiCepat</option>
<option value="idexpress">ID Express</option>
<option value="wahana">Wahana</option>
<option value="anteraja">AnterAja</option>
<option value="ninjavan">Ninja Xpress</option>
<option value="pos-indonesia">Pos Indonesia</option>
<option value="tiki">TIKI</option>
<option value="lion-parcel">Lion Parcel</option>
</select>
</div>

<div class="form-group">
<label>Layanan</label>
<select id="service">
<option value="reg">Reguler</option>
<option value="exp">Express</option>
<option value="sameday">Same Day</option>
</select>
</div>

<div class="form-group">
<label>Berat (kg)</label>
<input type="number" id="weight" step="0.1" required>
</div>

<div class="form-group">
<label>Ongkir Otomatis (Rp)</label>
<input type="text" id="shippingCost" readonly>
</div>

<button type="submit">Kirim via WhatsApp</button>

</form>

<hr style="margin:40px 0">

<h2>ðŸ”Ž Lacak Resi</h2>

<div class="form-group">
<label>Pilih Ekspedisi</label>
<select id="trackCourier">
<option value="jne">JNE</option>
<option value="jnt">J&T Express</option>
<option value="sicepat">SiCepat</option>
<option value="idexpress">ID Express</option>
<option value="wahana">Wahana</option>
<option value="anteraja">AnterAja</option>
<option value="ninjavan">Ninja Xpress</option>
<option value="pos-indonesia">Pos Indonesia</option>
<option value="tiki">TIKI</option>
<option value="lion-parcel">Lion Parcel</option>
</select>
</div>

<div class="form-group">
<input type="text" id="trackingNumber" placeholder="Masukkan nomor resi">
</div>

<button onclick="trackResi()">Lacak Sekarang</button>

<div class="result" id="trackingResult" style="display:none"></div>

</div>

<footer>Â© 2026 A & H Express</footer>

<script>

// ======================
// CEK ONGKIR OTOMATIS
// ======================

function hitungOngkir(){
let weight = parseFloat(document.getElementById("weight").value);
let service = document.getElementById("service").value;

if(!weight) return;

let base = 10000; // harga per kg dasar

if(service === "exp") base = 15000;
if(service === "sameday") base = 25000;

let total = Math.ceil(weight) * base;

document.getElementById("shippingCost").value =
new Intl.NumberFormat("id-ID").format(total);
}

document.getElementById("weight").addEventListener("input", hitungOngkir);
document.getElementById("service").addEventListener("change", hitungOngkir);


// ======================
// KIRIM WHATSAPP
// ======================

document.getElementById("orderForm").addEventListener("submit",function(e){
e.preventDefault();

let courier = document.getElementById("courier").value.toUpperCase();
let service = document.getElementById("service").value;
let weight = document.getElementById("weight").value;
let cost = document.getElementById("shippingCost").value;

let message =
`ðŸ“¦ *FORM PENGIRIMAN A & H EXPRESS*

ðŸšš Ekspedisi : ${courier}
âš¡ Layanan : ${service}
ðŸ“¦ Berat : ${weight} kg
ðŸ’° Ongkir : Rp ${cost}`;

let url = `https://wa.me/6282141285551?text=${encodeURIComponent(message)}`;
window.open(url,"_blank");
});


// ======================
// TRACKING REALTIME FIX
// ======================

async function trackResi(){
let tn = document.getElementById("trackingNumber").value.trim();
let slug = document.getElementById("trackCourier").value;
let box = document.getElementById("trackingResult");

if(!tn){
alert("Masukkan nomor resi terlebih dahulu");
return;
}

box.style.display="block";
box.innerHTML="<div class='loading'>Menghubungkan ke server...</div>";

try{

let res = await fetch("/api/track",{
method:"POST",
headers:{"Content-Type":"application/json"},
body:JSON.stringify({
trackingNumber: tn,
slug: slug
})
});

let data = await res.json();

if(!data.ok){
box.innerHTML="<div class='error'>Resi tidak ditemukan / API belum aktif.</div>";
return;
}

let html = `<div class='success'><b>Status:</b> ${data.tracking.title || '-'}</div><br>`;

data.tracking.checkpoints.forEach(cp=>{
html += `
<div>
<b>${cp.time || ''}</b><br>
${cp.status}<br>
<i>${cp.location}</i>
<hr>
</div>`;
});

box.innerHTML = html;

}catch(err){
box.innerHTML="<div class='error'>Gagal koneksi ke server.</div>";
}

}

</script>

</body>
</html>
